<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLIMOTORS - Portal de Estaci贸n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .side-panel-transition { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        input:read-only { background-color: #f1f5f9; cursor: not-allowed; }
    </style>
</head>
<body class="bg-slate-50 font-sans text-slate-900 overflow-hidden">

    <div class="flex h-screen overflow-hidden">
        <main class="flex-1 h-screen overflow-y-auto p-4 md:p-12">
            <header class="flex justify-between items-center mb-10">
                <div>
                    <h2 class="text-3xl font-black text-slate-800 tracking-tight">Portal de Estaci贸n</h2>
                    <p class="text-slate-500">Gesti贸n de pedidos y suministro de combustible</p>
                </div>
                <button onclick="togglePanel()" class="bg-red-600 text-white px-8 py-4 rounded-2xl font-bold shadow-xl shadow-red-200 hover:bg-red-700 transition-all flex items-center gap-2">
                    <i class="fas fa-plus"></i> Nuevo Pedido
                </button>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-slate-900 p-8 rounded-[2.5rem] text-white shadow-2xl">
                    <p class="text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Cr茅dito Disponible</p>
                    <div id="creditoDisplay" class="text-4xl font-black text-emerald-400">$450,000.00</div>
                    <p class="text-[10px] text-slate-500 mt-4">Sujeto a historial de pagos</p>
                </div>
                <div class="bg-white p-8 rounded-[2.5rem] border border-slate-100 shadow-sm">
                    <p class="text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Pedidos del Mes</p>
                    <div class="text-4xl font-black text-slate-800">12</div>
                </div>
                <div class="bg-white p-8 rounded-[2.5rem] border border-slate-100 shadow-sm">
                    <p class="text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Estado de Tanques</p>
                    <div class="text-4xl font-black text-blue-600">65%</div>
                </div>
            </div>
        </main>

        <div id="overlay" onclick="togglePanel()" class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-40 hidden opacity-0 transition-opacity duration-300"></div>
        
        <div id="sidePanel" class="fixed right-0 top-0 h-full w-full max-w-lg bg-white z-50 shadow-2xl side-panel-transition translate-x-full">
            <div class="h-full flex flex-col p-8 overflow-y-auto">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="text-2xl font-black text-slate-800">Nuevo Pedido</h3>
                    <button onclick="togglePanel()" class="bg-slate-100 h-10 w-10 rounded-full flex items-center justify-center text-slate-500 hover:bg-slate-200"><i class="fas fa-times"></i></button>
                </div>

                <form id="orderForm" class="space-y-5 flex-1">
                    <div class="space-y-1">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Estaci贸n de Servicio</label>
                        <select id="estacion" required onchange="updateEstacionData()" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl font-bold outline-none focus:ring-2 focus:ring-red-500">
                            <option value="">Seleccione Estaci贸n</option>
                            <option value="estacion_norte">Estaci贸n Norte - Polimotors</option>
                            <option value="estacion_sur">Estaci贸n Sur - Polimotors</option>
                        </select>
                    </div>

                    <div class="space-y-1">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Direcci贸n de Entrega</label>
                        <input id="direccion" type="text" readonly placeholder="Se asignar谩 autom谩ticamente" class="w-full p-4 border border-slate-100 rounded-2xl font-medium text-slate-500">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Tipo</label>
                            <select id="tipoCombustible" onchange="calculateTotal()" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl font-bold">
                                <option value="Extra">Extra</option>
                                <option value="Supreme">Supreme</option>
                                <option value="Diesel">Diesel</option>
                            </select>
                        </div>
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Precio/L (Auto)</label>
                            <input id="precioLitro" type="text" readonly class="w-full p-4 border border-slate-100 rounded-2xl font-black text-red-600">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Cantidad (L)</label>
                            <input id="cantidad" type="number" required oninput="calculateTotal()" placeholder="0.00" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl font-bold">
                        </div>
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Total Estimado</label>
                            <input id="totalEstimado" type="text" readonly class="w-full p-4 border border-emerald-100 bg-emerald-50 rounded-2xl font-black text-emerald-700">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Fecha Entrega</label>
                            <input id="fecha" type="date" required class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl font-bold">
                        </div>
                        <div class="space-y-1">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Prioridad</label>
                            <select id="prioridad" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl font-bold">
                                <option value="Normal">Normal</option>
                                <option value="Urgente">Urgente </option>
                            </select>
                        </div>
                    </div>

                    <div class="space-y-1">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Notas de Entrega</label>
                        <textarea id="notas" rows="2" placeholder="Indicaciones para el conductor..." class="w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none"></textarea>
                    </div>

                    <button type="submit" class="w-full bg-slate-900 text-white p-5 rounded-[2rem] font-black text-lg shadow-xl hover:bg-red-600 transition-all active:scale-95">
                        <i class="fas fa-check-circle mr-2"></i> Confirmar Pedido
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // BASE DE DATOS IN-MANIPULABLE (Simulada para el ejemplo, pero debe venir de tu Backend)
        const dbEstaciones = {
            "estacion_norte": { direccion: "Av. Industrial #455, Zona Norte", precios: { "Extra": 22.50, "Supreme": 24.80, "Diesel": 23.10 }, credito: 500000 },
            "estacion_sur": { direccion: "Carr. Federal Km 12, Salida Sur", precios: { "Extra": 22.30, "Supreme": 24.60, "Diesel": 23.00 }, credito: 320000 }
        };

        function togglePanel() {
            const panel = document.getElementById('sidePanel');
            const overlay = document.getElementById('overlay');
            panel.classList.toggle('translate-x-full');
            overlay.classList.toggle('hidden');
            setTimeout(() => overlay.classList.toggle('opacity-100'), 10);
        }

        function updateEstacionData() {
            const estacionKey = document.getElementById('estacion').value;
            const data = dbEstaciones[estacionKey];
            
            if (data) {
                document.getElementById('direccion').value = data.direccion;
                document.getElementById('creditoDisplay').innerText = `$${data.credito.toLocaleString()}`;
                calculateTotal();
            } else {
                document.getElementById('direccion').value = "";
                document.getElementById('precioLitro').value = "";
            }
        }

        function calculateTotal() {
            const estacionKey = document.getElementById('estacion').value;
            const tipo = document.getElementById('tipoCombustible').value;
            const cantidad = parseFloat(document.getElementById('cantidad').value) || 0;
            
            if (estacionKey && dbEstaciones[estacionKey]) {
                const precio = dbEstaciones[estacionKey].precios[tipo];
                document.getElementById('precioLitro').value = `$${precio.toFixed(2)}`;
                const total = precio * cantidad;
                document.getElementById('totalEstimado').value = `$${total.toLocaleString()}`;
                
                // VALIDACIN DE CRDITO
                const credito = dbEstaciones[estacionKey].credito;
                const btn = document.querySelector('button[type="submit"]');
                if (total > credito) {
                    btn.disabled = true;
                    btn.innerHTML = "Cr茅dito Insuficiente";
                    btn.classList.replace('bg-slate-900', 'bg-slate-400');
                } else {
                    btn.disabled = false;
                    btn.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Confirmar Pedido';
                    btn.classList.replace('bg-slate-400', 'bg-slate-900');
                }
            }
        }

        document.getElementById('orderForm').onsubmit = async (e) => {
            e.preventDefault();
            // L贸gica de env铆o Fetch a /api/pedido...
            alert("Pedido enviado a validaci贸n y guardado en la nube.");
            togglePanel();
        };
    </script>
</body>
</html>